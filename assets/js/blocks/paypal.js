!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t){e.exports=window.wp.element},function(e,t){e.exports=window.wp.i18n},function(e,t){e.exports=window.wc.wcSettings},function(e,t){e.exports=window.wp.data},function(e,t){e.exports=window.wc.blocksCheckout},function(e,t){e.exports=window.wp.htmlEntities},function(e,t){e.exports=window.wc.wcBlocksRegistry},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a}));const o=(e,t,n)=>{const o=new FormData;return o.append("action",`wc_${t}_get_client_token`),o.append("nonce",n),fetch(e,{method:"POST",body:o}).then(e=>e.json()).then(e=>{if(e&&!e.success){const t=e.data&&e.data.message||"";throw new Error("Could not retrieve the client token via AJAX: "+t)}if(e&&e.success&&e.data)return e.data})},a=(e,t)=>{if(t&&t.nonce)return fetch(e,{method:"POST",body:r(t)}).then(e=>e.json())};function r(e,t,n){const o=t||new FormData;for(const t in e){if(!e.hasOwnProperty(t)||!e[t])continue;const a=n?`${n}[${t}]`:t;"object"==typeof e[t]?r(e[t],o,a):o.append(a,e[t])}return o}},,function(e,t){e.exports=window.wp.hooks},function(e,t,n){"use strict";n.r(t);var o=n(6),a=n(2);let r=null;const c=()=>{if(null!==r)return r;const e=Object(a.getSetting)("braintree_paypal_data",null);if(!e)throw new Error("Braintree Paypal initialization data is not available");const t=e.is_checkout_confirmation||!1;return r={ajaxUrl:e.ajax_url||"",buttonStyles:e.button_styles||{},buttonWidth:e.button_width||null,clientTokenNonce:e.client_token_nonce||"",setPaymentMethodNonce:e.set_payment_method_nonce||"",debug:e.debug||!1,description:e.description||"",forceBuyerCountry:e.force_buyer_country||"",integrationErrorMessage:e.integration_error_message||"Unknown error",isTestEnvironment:e.is_test_environment||!1,isPayPalPayLaterEnabled:e.is_paypal_pay_later_enabled||!1,isPayPalCardEnabled:e.is_paypal_card_enabled||!1,logoUrl:e.logo_url||"",messageLogoType:e.messaging_logo_type||"inline",messageLogoPosition:e.messaging_logo_position||"left",messageTextColor:e.messaging_text_color||"black",paymentErrorMessage:e.payment_error_message||"Unknown error",payPalDisabledFundingOptions:e.paypal_disabled_funding_options||[],payPalIntent:e.paypal_intent||"",paypalLocale:e.paypal_locale||"en_us",showSavedCards:e.show_saved_cards&&!t||!1,showSaveOption:e.show_save_option&&!t||!1,supports:e.supports||{},title:e.title||"",tokenizationForced:e.tokenization_forced||!1,isCheckoutConfirmation:e.is_checkout_confirmation||!1,payPalCustomerDetails:e.paypal_customer_details||{},cartPaymentNonce:e.cart_payment_nonce||"",cartHandlerUrl:e.cart_handler_url||"",cartCheckoutEnabled:e.cart_checkout_enabled||!1},r},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;c().debug&&(console.log("Braintree (PayPal): "+e),t&&console.log(t))};var i=n(0),l=n(1),p=n(3),u=n(9);const{buttonWidth:d,integrationErrorMessage:m}=c(),b=e=>{let{loadPayPalSDK:t,onError:n,buttonLoaded:o,isCheckoutConfirmation:a=!1}=e;const r=Object(i.useRef)(!1),c="wc-braintree-paypal-button-container";if(Object(i.useEffect)(()=>{let e,a;return r.current=!0,async function(){try{const{dataCollectorInstance:n,paypalCheckoutInstance:s}=await t(c,r);r.current&&o(!0),e=s,a=n}catch(e){s("Integration Error: "+e.message,e),n(m)}}(),()=>{r.current=!1,o(!1),e&&e.teardown(),a&&a.teardown()}},[t,n,o]),a)return null;const l=d?{width:d+"px"}:{};return Object(i.createElement)("div",{id:c,style:l})},{buttonWidth:y,messageLogoType:g,messageLogoPosition:h,messageTextColor:w,isPayPalPayLaterEnabled:f}=c(),_=e=>{let{amount:t}=e;const n="wc-braintree-paypal-pay-later-messaging-container";Object(i.useEffect)(()=>{if(!f)return;const e=document.getElementById(n);return e?paypal.Messages?void paypal.Messages({amount:t,style:{layout:"text",logo:{type:g,position:h},text:{color:w}}}).render("#"+n).catch(e=>{s("Could not render the PayPal Pay Later messeging: "+e.message,e)}):e.style.display="none":void 0},[t]);const o=y?{width:y+"px"}:{};return Object(i.createElement)("div",{id:n,style:o})};var O=n(5),E=n(4);const{description:P,isTestEnvironment:j}=c(),S=e=>{let{testAmount:t,setTestAmount:n}=e;return Object(i.createElement)(i.Fragment,null,!!j&&Object(i.createElement)("span",null,Object(l.__)("TEST MODE ENABLED","woocommerce-gateway-paypal-powered-by-braintree")),Object(i.createElement)("p",null,Object(O.decodeEntities)(P||"")),!!j&&Object(i.createElement)(i.Fragment,null,Object(i.createElement)(E.ValidatedTextInput,{id:"wc-braintree-paypal-test-amount",type:"text",label:Object(l.__)("Test Amount","woocommerce-gateway-paypal-powered-by-braintree"),value:t,onChange:n}),Object(i.createElement)("p",{style:{fontSize:"10px"},dangerouslySetInnerHTML:{__html:Object(l.sprintf)(/** translators: Placeholders: %1$s - <a> tag, %2$s - </a> tag */
Object(l.__)("Enter a %1$stest amount%2$s to trigger a specific error response, or leave blank to use the order total.","woocommerce-gateway-paypal-powered-by-braintree"),'<a href="https://developers.braintreepayments.com/reference/general/testing/php#test-amounts">',"</a>")}})))};var k=n(7);const{ajaxUrl:v,clientTokenNonce:C,isTestEnvironment:T,buttonStyles:x,payPalIntent:A,isPayPalPayLaterEnabled:M,isPayPalCardEnabled:R,payPalDisabledFundingOptions:D,tokenizationForced:L,paypalLocale:F,forceBuyerCountry:B,cartPaymentNonce:I,cartHandlerUrl:N,setPaymentMethodNonce:U,paymentErrorMessage:z}=c(),K=e=>{let{billing:{cartTotal:t,currency:n},onSubmit:o,shouldSavePayment:a,token:r=null,isExpress:c=!1,needsShipping:l=!1}=e;const[p,u]=Object(i.useState)(I||""),[d,m]=Object(i.useState)(""),[b,y]=Object(i.useState)(""),g=n.code,h=(t.value/10**n.minorUnit).toFixed(2),w=Object(i.useMemo)(()=>!a&&!L,[a]);c&&(x.label="checkout");const f=Object(i.useCallback)((e,t)=>{const n={env:T?"sandbox":"production",commit:!c,style:x,onApprove:(t,n)=>e.tokenizePayment(t).then((function(e){if(s("Payment tokenized.",e),c&&e)return e.wp_nonce=U,Object(k.b)(N,e).then(e=>{if(!e||!e.redirect_url)throw new Error(z);window.location=e.redirect_url}).catch(e=>{u(""),s("Payment Error: "+e.message,e)});u(e.nonce),o()})),onError(e){u(""),s("Payment Error: "+e.message,e)}},a=()=>e.createPayment({flow:w?"checkout":"vault",intent:w?A:"tokenize",amount:h,currency:g,locale:F,enableShippingAddress:l});w?n.createOrder=a:n.createBillingAgreement=a;const r=document.getElementById(t);if(r&&(r.innerHTML=""),document.getElementById(t))return paypal.Buttons(n).render("#"+t)},[h,g,c,w,l,o]),_=Object(i.useMemo)(()=>{const[e,t]=[[],D];R||t.push("card"),M?e.push("paylater"):t.push("paylater");const n={components:M?"buttons,messages":"buttons",currency:g,intent:w?A:"tokenize",vault:!w,commit:!c};return e.length&&(n["enable-funding"]=e.join(",")),t.length&&(n["disable-funding"]=t.join(",")),B&&(n["buyer-country"]=B),n},[g,w,c]),O=Object(i.useCallback)((async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{braintree:n}=window,o={},a=await Object(k.a)(v,"braintree_paypal",C);s("Creating client");const r=await n.client.create({authorization:a});s("Client ready");try{const e=await n.dataCollector.create({client:r});e&&e.deviceData&&(t.current&&m(e.deviceData),o.dataCollectorInstance=e)}catch(e){s(e)}if(e){s("Creating integration");const t=await n.paypalCheckout.create({client:r});await t.loadPayPalSDK(_),await f(t,e),o.paypalCheckoutInstance=t,s("Integration ready")}return o}),[f,_]),E=Object(i.useCallback)(()=>{const e={wc_braintree_paypal_payment_nonce:p,wc_braintree_device_data:d};return w||(e["wc-braintree-paypal-tokenize-payment-method"]=!0),r&&(e["wc-braintree-paypal-payment-token"]=r,e.token=r,e.isSavedToken=!0),b&&(e["wc-braintree-paypal-test-amount"]=b),e},[d,w,p,b,r]);return{amount:h,testAmount:b,setTestAmount:y,loadPayPalSDK:O,getPaymentMethodData:E}},H=e=>{let{checkoutFormHandler:t,eventRegistration:n,emitResponse:o}=e;const{onPaymentProcessing:a,onCheckoutAfterProcessingWithError:r,onCheckoutAfterProcessingWithSuccess:s}=n,{getPaymentMethodData:l}=t;return((e,t,n)=>{Object(i.useEffect)(()=>e(()=>{const e=n();return e&&(e.token||e.wc_braintree_paypal_payment_nonce)?{type:t.responseTypes.SUCCESS,meta:{paymentMethodData:e}}:{type:t.responseTypes.ERROR,message:c().paymentErrorMessage,messageContext:t.noticeContexts.PAYMENTS}}),[t.responseTypes.SUCCESS,e,n,t.responseTypes.ERROR,t.noticeContexts.PAYMENTS])})(a,o,l),((e,t,n)=>{Object(i.useEffect)(()=>{const o=e=>{let t={type:n.responseTypes.SUCCESS};const{paymentStatus:o,paymentDetails:a}=e.processingResponse;return o===n.responseTypes.FAIL&&a.result===n.responseTypes.FAIL&&a.message&&(t={type:n.responseTypes.FAIL,message:a.message,messageContext:n.noticeContexts.PAYMENTS,retry:!0}),t},a=e(o),r=t(o);return()=>{a(),r()}},[e,t,n.noticeContexts.PAYMENTS,n.responseTypes.FAIL,n.responseTypes.SUCCESS])})(r,s,o),null},{isCheckoutConfirmation:Y,payPalCustomerDetails:W}=c(),$=Object(a.getSetting)("isBlockTheme")?"wc-block-components-notice-banner is-error":"woocommerce-error",q=(e,t)=>t?(Object.keys(t).forEach(e=>{""===t[e]&&delete t[e]}),{...e,...t}):e,J=e=>{const[t,n]=Object(i.useState)(null),[o,a]=Object(i.useState)(!1),{eventRegistration:r,emitResponse:c,activePaymentMethod:s,components:{LoadingMask:l},billing:u,onSubmit:d,shouldSavePayment:m,token:y,shippingData:g}=e,h=K({billing:u,onSubmit:d,shouldSavePayment:m,token:y,isExpress:!1,needsShipping:g.needsShipping}),{loadPayPalSDK:w,testAmount:f,setTestAmount:O,amount:E}=h;return Object(i.useEffect)(()=>{if(Y)return;const e=document.querySelector("button.wc-block-components-checkout-place-order-button");return e?("braintree_paypal"===s&&e.setAttribute("disabled","disabled"),()=>{e.removeAttribute("disabled")}):void 0},[s]),Object(i.useEffect)(()=>{if(Y&&W&&!window.wcBraintreePayPalAddressFilled){try{const{billing:e,shipping:t}=W,n=Object(p.select)("wc/store/cart").getCustomerData(),o={};o.billing=q(n.billingAddress,e),o.shipping=q(n.shippingAddress,t),o.billing&&Object(p.dispatch)("wc/store/cart").setBillingAddress(o.billing),g.needsShipping&&o.shipping&&Object(p.dispatch)("wc/store/cart").setShippingAddress(o.shipping)}catch(e){console.error(e)}window.wcBraintreePayPalAddressFilled=!0}},[]),Object(i.createElement)(i.Fragment,null,!Y&&Object(i.createElement)(S,{testAmount:f,setTestAmount:O}),t&&Object(i.createElement)("div",{className:$},t),!t&&Object(i.createElement)(l,{isLoading:!o,showSpinner:!0},o&&!Y&&Object(i.createElement)(_,{amount:E}),Object(i.createElement)(b,{loadPayPalSDK:w,onError:n,buttonLoaded:a,isCheckoutConfirmation:Y})),Object(i.createElement)(H,{checkoutFormHandler:h,eventRegistration:r,emitResponse:c}))},{PAYMENT_STORE_KEY:V}=window.wc.wcBlocksData,{logoUrl:X,title:G,showSavedCards:Q,showSaveOption:Z,supports:ee,isCheckoutConfirmation:te}=c(),ne=e=>{let{RenderedComponent:t,...n}=e;return Object(p.select)("core/editor")?null:Object(i.createElement)(t,n)};let oe=ee;te&&(Object(u.addAction)("experimental__woocommerce_blocks-checkout-render-checkout-form","woocommerce-gateway-paypal-powered-by-braintree",()=>{Object(p.dispatch)(V).__internalSetActivePaymentMethod("braintree_paypal")}),oe=[...ee,"braintree_paypal_checkout_confirmation"]);var ae={name:"braintree_paypal",label:Object(i.createElement)(()=>Object(i.createElement)("img",{src:X,alt:G}),null),ariaLabel:Object(l.__)("Braintree PayPal Payment Method","woocommerce-gateway-paypal-powered-by-braintree"),canMakePayment:()=>!0,content:Object(i.createElement)(ne,{RenderedComponent:J}),edit:Object(i.createElement)(ne,{RenderedComponent:J}),savedTokenComponent:Object(i.createElement)(ne,{RenderedComponent:e=>{const{eventRegistration:t,emitResponse:n}=e,o=K(e),{loadPayPalSDK:a}=o,r=Object(i.useRef)(!1);return Object(i.useEffect)(()=>{let e;return r.current=!0,async function(){const{dataCollectorInstance:t}=await a("",r);e=t}(),()=>{r.current=!1,e&&e.teardown&&e.teardown()}},[a]),Object(i.createElement)(H,{checkoutFormHandler:o,eventRegistration:t,emitResponse:n})}}),supports:{showSavedCards:Q||!1,showSaveOption:Z||!1,features:oe||[]}};const re=Object(a.getSetting)("isBlockTheme")?"wc-block-components-notice-banner is-error":"woocommerce-error",ce=e=>{const[t,n]=Object(i.useState)(null),[o,a]=Object(i.useState)(!1),{components:{LoadingMask:r},billing:c,onSubmit:s,shouldSavePayment:l,token:p,shippingData:u}=e,d=K({billing:c,onSubmit:s,shouldSavePayment:l,token:p,isExpress:!0,needsShipping:u.needsShipping}),{loadPayPalSDK:m,amount:y}=d;return Object(i.createElement)(i.Fragment,null,t&&Object(i.createElement)("div",{className:re},t),!t&&Object(i.createElement)(r,{isLoading:!o},o&&Object(i.createElement)(_,{amount:y}),Object(i.createElement)(b,{loadPayPalSDK:m,onError:n,buttonLoaded:a})))},{supports:se}=c(),ie=e=>{let{RenderedComponent:t,...n}=e;return Object(p.select)("core/editor")?null:Object(i.createElement)(t,n)};var le={name:"braintree_paypal_express",canMakePayment:()=>!0,content:Object(i.createElement)(ie,{RenderedComponent:ce}),edit:Object(i.createElement)(ie,{RenderedComponent:ce}),supports:{features:se||[]}};const{cartCheckoutEnabled:pe}=c();Object(o.registerPaymentMethod)(ae),pe&&Object(o.registerExpressPaymentMethod)(le)}]);